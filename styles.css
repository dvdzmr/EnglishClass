:root{
  --bg: #0f1115;
  --panel: #151823;
  --panel-2:#1a1f2e;
  --text:#e9eef7;
  --muted:#9aa5c1;
  --accent:#6ea8fe;
  --accent-2:#8ed0a9;
  --ring:#2b3753;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; background:linear-gradient(180deg,var(--bg),#0c0f14);
  color:var(--text); font:16px/1.5 system-ui,Segoe UI,Roboto,Inter,Arial;
}
.hidden{display:none !important}
.view{min-height:100%; display:flex; flex-direction:column}

.topbar{
  position:sticky; top:0; z-index:5;
  display:flex; align-items:center; gap:1rem;
  padding:0.75rem 1rem; background:color-mix(in oklab, var(--panel) 85%, black);
  border-bottom:1px solid var(--ring);
  backdrop-filter:saturate(1.2) blur(6px);
}
.topbar h1{font-size:1.1rem; margin:0}
.link{
  background:none; border:none; color:var(--accent); cursor:pointer; padding:0; font-weight:600;
}
.spacer{flex:1}

.grid{
  display:grid; gap:1rem; padding:1rem;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}
.card{
  background:var(--panel); border:1px solid var(--ring); border-radius:12px;
  padding:1rem; display:flex; flex-direction:column; gap:.5rem;
  transition:transform .08s ease, border-color .08s ease;
}
.card:hover{transform:translateY(-2px); border-color:var(--accent)}
.card h3{margin:.25rem 0 .5rem}
.card button{
  align-self:flex-start; background:var(--accent); color:#05111f;
  border:none; border-radius:8px; padding:.5rem .75rem; font-weight:700; cursor:pointer;
}

#stageContainer{flex:1; display:flex; align-items:stretch; justify-content:center; padding:1rem; max-width:1200px; margin-inline:auto; width:100%}
.reading, .watch, .qanda{
  width:min(900px,100%); background:var(--panel); border:1px solid var(--ring); border-radius:12px; padding:1rem 1.2rem;
  box-shadow:0 0 0 1px #000 inset, 0 10px 30px rgba(0,0,0,.25);
}
.reading-title{margin:.25rem 0 1rem; font-size:1.25rem; color:var(--accent-2)}
.md p{margin:.6rem 0}
.md h1,.md h2,.md h3{margin:.8rem 0 .4rem}
.md strong{color:#fff}
.md blockquote{
  margin:.6rem 0; padding:.6rem .8rem; background:var(--panel-2); border-left:3px solid var(--accent);
  border-radius:6px 8px 8px 6px; color:var(--muted)
}

.dialogue{
  position:relative; overflow:hidden; border-radius:14px; width:100%;
  display:flex; align-items:center; justify-content:center;
  border:1px solid var(--ring); background:#000;
}
.dialogue-bg{
  width:100%; height:72vh; object-fit:cover; filter:saturate(1.1) contrast(1.05);
}
.dialogue-overlay{
  position:absolute; bottom:0; left:0; right:0; padding:1rem 1.25rem;
  background:linear-gradient(180deg,rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 38%, rgba(0,0,0,.8) 100%);
}
.dialogue-overlay h2{margin:.2rem 0 .2rem}
.dialogue-overlay p{margin:0; color:#e6eefc}

.video-wrap{
  position:relative; width:100%; aspect-ratio:16/9; background:#000; border-radius:10px; overflow:hidden; border:1px solid var(--ring)
}
.video-wrap iframe{width:100%; height:100%; border:0}

.qanda-img{
  width:100%; height:240px; object-fit:contain; display:block; margin:.5rem 0 1rem
}
.confetti-btn{
  margin-top:.75rem; background:var(--accent-2); color:#042014; border:none; border-radius:8px; padding:.6rem .9rem;
  font-weight:800; cursor:pointer
}

.bottombar{
  position:sticky; bottom:0; z-index:5; display:flex; align-items:center; justify-content:center; gap:1rem;
  padding:.5rem; background:color-mix(in oklab, var(--panel) 85%, black); border-top:1px solid var(--ring);
}
.nav-btn{
  background:var(--panel-2); color:var(--text); border:1px solid var(--ring);
  width:42px; height:42px; border-radius:10px; font-size:1.1rem; cursor:pointer
}
.nav-btn:disabled{opacity:.38; cursor:not-allowed}
.stage-indicator{color:var(--muted); font-size:.95rem}

.difficulty-dock{
  display:flex; align-items:center; gap:.75rem; padding:.25rem .5rem;
  border:1px solid var(--ring); border-radius:10px; background:var(--panel-2); color:var(--muted)
}
.difficulty-dock input{accent-color:var(--accent)}
/* hidden on dialogue stage */
.difficulty-hidden{visibility:hidden}
